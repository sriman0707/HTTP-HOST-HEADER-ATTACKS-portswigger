This lab is vulnerable to password reset poisoning. The user carlos will carelessly click on any links in emails that he receives. To solve the lab, log in to Carlos's account.
You can log in to your own account using the following credentials: wiener:peter. Any emails sent to this account can be read via the email client on the exploit server.
So lets access the lab:-

 
Step:1
By clicking Access The lab We Get the Web Interface  
Step:2
Lets Go To login And 
 

Click on forgot password, We Get interface like this

 
We get like this give user name as wiener and click on submit button 
Step:3
So next we get as
 
Like this so next 
Go to exploit server Click On it

 
Here We crafted a response so at the bottom we see that
Store,View Exploit,Access log and Email client
Step:4
Click on Email client,We get the interface like this
 
Step5:
Click On The Marked Link And Change the Password as you need.

Note:While doing your practical you dont get same link You get your own link

 

Step:6


Next In Burp>>Go TO HTTP history>>And Chcek for /-forgot-password

Click on it you see the request response. Like in the image it shown

 

And Now Send This Request to burp repeater..

Step:7

Switch To repeater
Change the Host header as you like
 
I changed it as Hello123
 


And Send The request again



It Show The request is accepted
Below in the image you can se that

HTTP/200 OK
 


Step:8

Now We need to open our email client and refresh the browser window

You can see that our new one is created with Hello123
 



Step:9

 
Set a new Host header with the header of our exploit server,copy the link upto exploit-server.net leave front https also

See in image how i copied same as it is you da that thing only

 
Paste it on burp repeater in host and change the user name as u need
send the request again
 


Step:10

Now go to access log

 
And there we need to look for get request from different ip address
 
We got that see there in above pic
Step:11

Copy the new token and 
Open a new tab and paste it on there
Back to our exploit server and open email client again
And now we need to use our address of first password reset address 
The below image you see that you can chicken on that link its going to redirect another page shows invalid token

 
Step:12
After clicking that link Replace the marked token id with our previous we get on access log,refresh the page again,you will get a new interface to change the pasword for your new user. Click on submit.

 



Step:13

And Now you go to login page and login with your new user id and password. 

 
Step:14

And there you see that congratulations,you solved the lab
Thatsit with this lab you have solved itâ€¦ 

 
Thankyou.

